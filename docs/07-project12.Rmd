---
title: "Do it! ?????? ????????? R ????????? ????????? - 07 ????????? ????????? ????????????: ?????? ????????? ?????? ?????? ??????"
author: "?????????"
output:
  xaringan::moon_reader:
    seal: false
    css: ["default", "css/custom_06.css"]
    lib_dir: libs
    chakra: libs/remark-latest.min.js
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: true
      ratio: '16:10'
      navigation:
        scroll: true
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE,
        width = 80,
        # width = 70,

        max.print = 80,
        tibble.print_max = 40,

        tibble.width = 80,
        # tibble.width = 70,

        # pillar.min_chars = Inf, # tibble ?????? ?????? ??????
        servr.interval = 0.01) # Viewer ?????? ?????? ??????


knitr::opts_chunk$set(cache = T,
                      warning = F,
                      message = F,
                      dpi = 300,
                      fig.height = 4)

# xaringanExtra::use_tile_view()

library(knitr)
library(icon)
library(here)
```


```{r echo=FALSE}
rm(list = ls())

library(showtext)
font_add_google(name = "Nanum Gothic", family = "nanumgothic")
showtext_auto()
showtext_opts(dpi = 300) # opts_chunk$set(dpi=300)

# code highlighting
hook_source <- knitr::knit_hooks$get('source')
knitr::knit_hooks$set(source = function(x, options) {
  x <- stringr::str_replace(x, "^[[:blank:]]?([^*].+?)[[:blank:]]*#<<[[:blank:]]*$", "*\\1")
  hook_source(x, options)
})


# rmarkdown crayon setup
options(crayon.enabled = TRUE)
knitr::knit_hooks$set(message = function(x, options){
  paste0(
    "<pre class=\"r-output\"><code>",
    fansi::sgr_to_html(x = x, warn = FALSE),
    "</code></pre>"
  )
})

# crayon colour setup
num_colors <- function(forget=TRUE) 256
library(crayon)
assignInNamespace("num_colors", num_colors, pos="package:crayon") 

```


class: title0

Do it! ?????? ????????? R ????????? ?????????

---

class: no-page-num

<br>

.pull-left[
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
```{r, echo=FALSE, out.width="70%", out.height="70%"}
include_graphics("https://raw.githubusercontent.com/youngwoos/Doit_textmining/main/cover.png")
```
]

.pull-right[

<br>
<br>
<br>

`r fontawesome("github")` [github.com/youngwoos/Doit_textmining](https://github.com/youngwoos/Doit_textmining)

`r fontawesome("facebook-square")` [facebook.com/groups/datacommunity](https://facebook.com/groups/datacommunity)

- [????????????](https://book.naver.com/bookdb/book_detail.nhn?bid=17891971)
  - [yes24](http://bit.ly/3oUuJOB)
  - [?????????](http://bit.ly/3oXOSDn)
  - [????????????](https://bit.ly/2LtNOcB)
]

---

class: title0

07 ????????? ????????? ????????????:  
?????? ????????? ?????? ?????? ??????

---

class: title0-2

We'll make

<br-back-30>

```{r, echo=FALSE, out.width="50%"}
include_graphics("Image/07/07_2_1.png")
```

---

class: title0-2

We'll make

<br-back-30>

```{r, echo=FALSE, out.width="62%"}
include_graphics("Image/07/07_4_3.png")
```

---

class: title0-2

and

<br-back-40>

```{r, echo=F, out.width="50%"}
include_graphics("Image/07/07_5_4.png")
```

---

<br>

.large2[.font-jua[??????]]

.large[.font-jua[07-1 ?????? ?????? ????????????]]([link](#07-1))

.large[.font-jua[07-2 ??????, ????????? ?????? ???????????? ]]([link](#07-2))

.large[.font-jua[07-3 ?????? ?????? ????????????]]([link](#07-3))

.large[.font-jua[07-4 ?????? ??? ?????? ????????????]]([link](#07-4))

.large[.font-jua[07-5 ?????? ?????????]]([link](#07-5))

---

name: 07-1
class: title1

07-1 ?????? ?????? ????????????

---

#### ?????? ?????????(??????????????? ??????????????? ?????????)
- 2019??? 12??? 5??? ?????? ????????????????????? ???????????????????????? ??????
- ?????? ??????: ?????? ???????????? 11~15?????? ???????????? ????????? ???????????? ???????????? ????????? ??? ??????
- ????????? ??? ?????? ???????????? ????????? ??? ?????? ??????

--

##### ?????? ??????
- 1.?????? ????????? ????????????.
- 2.?????? ???????????? ????????? ?????? ????????? ???????????????.


---


#### ???????????? ?????????

- ?????? ????????? ?????? ????????? ?????? ?????? ?????? ????????????: `news_comment_tada.csv`

```{r eval=F}
# ????????? ????????????
library(readr)
library(dplyr)

raw_tada <- read_csv("news_comment_tada.csv") %>%
  mutate(id = row_number())

glimpse(raw_tada)
```

---

```{r echo=F, R.options=list(tibble.width = 60)}
library(readr)
library(dplyr)

raw_tada <- read_csv(here::here("Data/news_comment_tada.csv")) %>%
  mutate(id = row_number())

glimpse(raw_tada)
```

---

#### ???????????? ?????????

- ???????????? 1??? ?????? ????????? ????????? ??????: ???????????? ?????? ?????? ???????????? `KoNLP` ????????? ?????? ??????
- ?????? ????????? ??? ???????????? ?????? `reply`?????? html ?????? ????????? `reply_raw`??? ??????
- ????????????????????? ???????????? ??? ??????????????? `reply`?????? ????????? ????????? ?????? ?????? ??????

```{r}
library(stringr)
library(textclean)

tada <- raw_tada %>%
  filter(str_count(reply, " ") >= 1) %>%                   # ???????????? 1??? ?????? ??????
  mutate(reply_raw = str_squish(replace_html(reply)),      # ?????? ??????
         reply = str_replace_all(reply, "[^???-???]", " "),  # ????????? ?????????
         reply = str_squish(reply))                        # ?????? ?????? ??????
```

---

### 7.1.2 ?????? ?????? ????????????

#### 1. ?????? ?????? ????????????

- ????????? ????????? ????????? ?????? ?????? ?????? 30??? ?????? ??????

```{r}

library(tidytext)
library(KoNLP)

word_noun <- tada %>%
  unnest_tokens(input = reply,
                output = word,
                token = extractNoun,
                drop = F)

# ?????? ?????? ?????????
frequency <- word_noun %>%
  count(word, sort = T) %>%    # ?????? ?????? ?????? ???????????? ??????
  filter(str_count(word) > 1)  # ??? ?????? ????????? ?????????
```

---

<br10>

.scroll-box-26[
```{r}
# ?????? ?????? ??????
frequency %>%
  head(30)
```
]

---

#### 2. ????????? ????????????

- ????????? ?????? ??? ?????? ?????? ?????? 20??? ?????? ??????

```{r top20_noun, results='hide'}
# ????????? ?????? ??????
stopword_noun <- c("??????", "??????", "??????", "??????")

# ?????? ?????? ?????? ?????????
top20_noun <- frequency %>%
  filter(!word %in% stopword_noun) %>%
  head(20)

top20_noun
```

---

```{r ref.label="top20_noun", echo=F}

```

---

#### 3. ?????? ????????? ?????????

```{r p_top20_noun, eval=F}
library(scales)
library(ggplot2)

ggplot(top20_noun, aes(x = reorder(word, n), y = n)) +
  geom_col() +
  coord_flip() +
  geom_text(aes(label = comma(n, accuracy = 1)), hjust = -0.3) +
  scale_y_continuous(limits = c(0, 3200)) +

  labs(title = "?????? ????????? ?????? ?????? ?????? ??????",
       subtitle = "?????? ?????? Top 20",
       x = NULL) +

  theme_minimal() +
  theme(text = element_text(family = "nanumgothic", size = 12),
        plot.title = element_text(size = 14, face = "bold"),      # ?????? ??????
        plot.subtitle = element_text(size = 13))                  # ????????? ??????
```

`r fontawesome("lightbulb")` `comma(n, accuracy = 1)`: ??? ??????????????? ?????? ??????, ????????? ?????? ???????????? ?????????. <br>&nbsp;&nbsp;&nbsp;&nbsp;`scales` ????????? ?????? ??????

---

```{r ref.label="p_top20_noun", fig.width=7, fig.height=6, out.width = '70%', echo = F}

```

---

.pull-left[

- ?????? ??????
  - `"??????"`, `"??????"`: ????????? ????????? ??????
  - `"??????"`, `"?????????"`, `"??????"`:  ????????? ??????
  - `"??????"`, `"????????????"`: ?????? ?????? ??????

]
.pull-right[

```{r ref.label="p_top20_noun", fig.width=7, fig.height=6, echo = F}

```
]


---

name: 07-2
class: title1

07-2 ??????, ????????? ?????? ????????????

---


##### ?????? ??????
 - 1.?????? ????????? ?????? ????????? ?????? ??????, ???????????? wide form?????? ????????? ?????? ???????????? ????????????.
 - 2.????????? ????????? ?????????????????? ??????????????? ????????? ????????? ????????? ?????? ???????????? ????????????.
 - 3.?????? ????????? ????????? ?????? ????????? ???????????????.

---




#### ?????? ????????? ?????????

##### 1. ?????? ?????? ?????? ?????????

- '?????? ???'??? '????????? ???' ?????? ????????? `diff` ??????
- ?????? ?????? ????????? `sympathy` ??????

```{r}
word_sympathy <- word_noun %>%
  rename(like = sympathyCount,
         dislike = antipathyCount) %>%

  mutate(diff = like - dislike,
         sympathy = ifelse(diff >=  1, "like",
                    ifelse(diff <= -1, "dislike", "neutral")))
```

---


##### `sympathy`??? ?????? ???

- ???????????? ??? ????????? ?????? ??? `sympathy`??? ?????? ?????????
- `word_sympathy`??? ??? ?????? ????????? ??????????????? ?????? ????????? ???????????? ??????

```{r}
# ?????? ????????? ?????? ???
word_sympathy %>%
  distinct(id, .keep_all = T) %>%
  count(sympathy, sort = T)
```

---


##### 2. ?????? ????????? ?????????

- ?????? ?????? ??? ????????? ?????? ?????????: ??????, ????????? ?????? ????????? ??????????????? ?????? ????????? ??????
- wide form?????? ????????? ?????? ????????? ?????????
  - ????????? `"dislike"`, ????????? `"like"`??? ????????? ?????? ????????????
    - ?????? ????????? ?????? ???????????? ??????????????? ????????? ??????
    - ?????? ???????????? ????????? ???????????? ??????????????? ????????? ??????

```{r}
# ?????? ?????? ?????????
frequency_sympathy <- word_sympathy %>%
  count(sympathy, word) %>%              # ?????? ?????? ??? ????????? ??????
  filter(str_count(word) > 1 &           # ??? ?????? ?????? ??????
         sympathy != "centrism")         # centrism ??????

# Wide form?????? ????????????
library(tidyr)
frequency_wide <- frequency_sympathy %>%
  pivot_wider(names_from = sympathy,
              values_from = n,
              values_fill = list(n = 0))
```

---

##### 2. ?????? ????????? ?????????

- ?????? ?????? ??? ????????? ?????? ?????????: ??????, ????????? ?????? ????????? ??????????????? ?????? ????????? ??????
- wide form?????? ????????? ?????? ????????? ?????????
  - ????????? `"dislike"`, ????????? `"like"`??? ????????? ?????? ????????????
    - ?????? ????????? ?????? ???????????? ??????????????? ????????? ??????
    - ?????? ???????????? ????????? ???????????? ??????????????? ????????? ??????
```{r}
# ?????? ????????? ?????????
frequency_wide <- frequency_wide %>%
  mutate(log_odds_ratio = log(((like    + 1) / (sum(like    + 1))) /
                              ((dislike + 1) / (sum(dislike + 1)))))
```

---

```{r}
frequency_wide %>%
  arrange(-log_odds_ratio)
```


---


#### ?????? ?????? ????????????

##### 1. ?????? ?????? ????????????

- ???????????? 20??? ?????? ????????? ?????? ??????
- ?????? ???????????? 0?????? ?????? `"like"`, ??? ????????? `"dislike"`??? ??????
- ?????? ???????????? ?????? ????????? ?????? ????????? 10?????? ??????
```{r top10_odds, results='hide'}
top10_odds <- frequency_wide %>%
  filter(like >= 20 | dislike >= 20) %>%
  group_by(sympathy = ifelse(log_odds_ratio > 0, "like", "dislike")) %>%
  slice_max(abs(log_odds_ratio), n = 10, with_ties = F)

top10_odds %>%
  arrange(log_odds_ratio)
```

---

```{r ref.label='top10_odds', echo=F}

```

---

##### 2. ?????? ????????? ?????????

```{r}
# ?????? ?????? ?????? ??????
col_sentiment <- c("#619CFF", "#F8766D")

# ?????? ?????? ??????
top10_odds$sympathy <- factor(top10_odds$sympathy,
                              levels = c("like", "dislike"))
```

---

##### 2. ?????? ????????? ?????????

```{r p_top10_odds, eval = F}
ggplot(top10_odds, aes(x = reorder(word, log_odds_ratio),
                       y = log_odds_ratio,
                       fill = sympathy)) +
  geom_col() +
  coord_flip() +
  scale_fill_manual(values = col_sentiment,          # ?????? ??????
                    labels = c("??????", "?????????")) +  # ?????? ??????

  labs(title = "?????? ????????? ?????? ?????? ?????? ??????",
       subtitle = "?????? vs ????????? ?????? ????????? Top 10",
       x = NULL, fill = NULL) +

  theme_minimal() +
  theme(text = element_text(family = "nanumgothic"),
        plot.title = element_text(size = 14, face = "bold"),
        plot.subtitle = element_text(size = 12))
```

---

```{r ref.label="p_top10_odds", fig.width=7, fig.height=6, out.width="80%", echo=F}

```

---

#### ?????? ?????? ????????????

##### 1. ?????? ????????? ????????? ?????? ????????????

```{r}
tada %>%
  filter(str_detect(reply_raw, "??????")) %>%
  head(3) %>%
  pull(reply)
```

---


##### 2. ????????? ????????? ?????? ????????? ?????? ?????? ????????????

##### 2.1 ???????????? ????????? ????????? - `combine_styles()`

```{r, echo=F}
# message = True for crayon setup
knitr::opts_chunk$set(message = T)
```

```{r eval=FALSE}
# ????????? ?????? ?????????
library(crayon)
font <- combine_styles(make_style("ivory"),
                       make_style("deeppink", bg = TRUE),
                       make_style("bold"))

font("????????? ????????? ??????") %>% cat()

```

```{r  echo=F}
# ????????? ?????? ?????????
library(crayon)
font <- combine_styles(make_style("ivory"),
                       make_style("deeppink", bg = TRUE),
                       make_style("bold"))

font("????????? ????????? ??????") %>% message()

```

---

##### `"??????"`??? ????????? ?????? ????????? ????????? ????????????
- `str_detect()`??? ????????? `"??????"`??? ????????? ?????? ??????
- `paste0()`??? `font()`??? ????????? `"??????"`??? ????????? ??????
- `pull()`??? ????????? `reply`??? ???????????? ????????? ?????? `cat()`??? ????????? ??????
  - `sep = "\n\n"` ??? ????????? ?????? ????????? ??? ?????? ??????

```{r eval=F}
# ?????? ?????? ??????
keyword <- "??????"

# ?????? ????????? ????????? ??????
tada %>%
  filter(str_detect(reply_raw, keyword)) %>%
  head(3) %>%
  mutate(reply = paste0(str_replace_all(reply,
                                        keyword,
                                        font(keyword)))) %>%  # ????????? ??????
  pull(reply) %>%                                             # reply ??????
  cat(sep = "\n\n")                                           # ????????? ??????
```

---

```{r echo=F}
# ?????? ?????? ??????
keyword <- "??????"

# ?????? ????????? ????????? ??????
tada %>%
  filter(str_detect(reply_raw, keyword)) %>%
  slice(1:3) %>%
  mutate(reply = paste0(reply, "<br>##<br>## ")) %>%
  mutate(reply = paste0(str_replace_all(reply,
                                        keyword,
                                        font(keyword)))) %>%  # ????????? ??????
  pull(reply) %>%                                             # reply ??????
  # cat(sep = "\n\n") %>%
  message()
```


---

##### 2.2 ?????? ????????? ????????? ???????????? ????????? ???????????? ????????? ?????? ?????????

```{r eval=F}
find_word <- function(df, x, keyword, n = 6) {

  # ????????? ?????? ??????
  font <- combine_styles(make_style("ivory"),
                         make_style("deeppink", bg = TRUE),
                         make_style("bold"))

  # ????????? ????????? ????????? ??????
  df %>%
    filter(str_detect({{x}}, keyword)) %>%                  # ????????? ??????
    head(n) %>%                                             # n??? ??????
    mutate(x = paste0("[", row_number(), "] ", {{x}}),      # ????????? ??????
           x = paste0(str_replace_all(x,
                                      keyword,
                                      font(keyword)))) %>%  # ????????? ??????
    pull(x) %>%                                             # ????????? ??????
    cat(sep = "\n\n")                                       # ????????? ??????
}
```

```{r echo=F}
# function for rmarkdown crayon output

find_word <- function(df, x, keyword, n = 6) {

  # ????????? ?????? ??????
  font <- combine_styles(make_style("ivory"),
                         make_style("deeppink", bg = TRUE),
                         make_style("bold"))

  # ????????? ??????
  df %>%
    filter(str_detect({{x}}, keyword)) %>%              # ????????? ??????
    slice(1:n) %>%                                      # n??? ??????

    mutate(x = paste0("[", row_number(), "] ", {{x}}),  # ????????? ??????
           x = paste0(x, "<br>##<br>## "))  %>%         # ????????? ??????

    pull(x) %>%                                           # ????????? ??????
    paste(., collapse = "") %>%                           # ?????????
    str_remove_all(., "<br>##<br>## $") %>%               # ????????? ## ??????
    str_replace_all(., keyword, font(keyword)) %>%        # ????????? ??????
    message()                                           # rmarkdown crayon output
}
```

---

- `find_word()`
 - `x`: ?????????
 - `keyword`: ???????????? ????????? ??????
 - `n`: ????????? ??? ???. ?????? ?????? ???????????? ????????? 6??? ??????

```{r}
tada %>% find_word(x = reply_raw, keyword = "??????", n = 2)
```

---

- `find_word()`: ??????????????? ???????????? ?????? ??????

```{r}
tada %>% find_word(reply_raw, "??????", 2)
```

<br10>

`r icon_style(fontawesome("exclamation-triangle"), fill = "#FF7333")` `dplyr`, `stringr`, `crayon` ????????? ?????? ??????.`find_word()`??? ?????? ???????????? `dplyr` ?????? ?????? ?????? ??????.

---


##### 3 ??????, ????????? ?????? ?????? ????????????

##### 3.1 `tada`??? `word_sympathy` ???????????? ?????? ?????? ????????????

- `tada`??? `word_sympathy` ????????????
  - `tada`: ?????? ??????
  - `word_sympathy`: `sympathy`(?????? ??????), `diff`(??????, ????????? ??? ??????)??? ?????? ??????
      - ??? ?????? ????????? ??????????????? ?????? ????????? ????????????  ??????
      - ???????????? ??? ????????? ????????? ?????? ????????? ????????? ?????? ??????

```{r}
tada <- tada %>%
  left_join(word_sympathy %>%
              distinct(id, .keep_all = T) %>%  # ?????? ?????? ??????
              select(id, sympathy, diff),      # ?????? ?????? ??????
            by = "id")
```

---

##### 3.2 ??????, ????????? ????????? ?????????

- ??????, ????????? ?????? ?????? ??????
  - ?????? ????????? ?????? ?????? ?????? ?????????, ????????? ????????? ????????? ?????? ?????? ????????? ??????
  - ???????????? ?????? ?????? ???????????? ????????? ??? ??????

```{r}
# ?????? ?????? ??????
reply_like <- tada %>%
  filter(sympathy  == "like") %>%      # like ??????
  arrange(-diff)                       # ?????? ????????? ??????

# ????????? ?????? ??????
reply_dislike <- tada %>%
  filter(sympathy  == "dislike") %>%   # dislike ??????
  arrange(diff)                        # ????????? ????????? ??????
```

---



##### 4. ?????? ?????? ?????? ????????????

- ?????? ???????????? ????????? ?????? ?????? ?????? ?????? ?????? ??????


```{r eval=F}
# ??????
reply_like %>% find_word(x = reply_raw, keyword = "??????", n = 10)
```
```{r echo=F}
# ??????
reply_like %>% find_word(x = reply_raw, keyword = "??????", n = 3)
```


---

```{r eval=F}
# ?????????
reply_like %>% find_word(x = reply_raw, keyword = "?????????", n = 10)
```
```{r echo=F}
# ?????????
reply_like %>% find_word(x = reply_raw, keyword = "?????????", n = 3)
```

---

```{r eval=F}
# ?????????
reply_like %>% find_word(x = reply_raw, keyword = "?????????", n = 10)
```


```{r echo=F}
# ?????????
reply_like %>% find_word(x = reply_raw, keyword = "?????????", n = 3)
```

---

##### ?????? ?????? ????????? ?????? ??????
- `"??????"`: ?????? ????????? ???????????? ????????? ???????????? ??????.
- `"?????????"`: ???????????? ????????? ???????????? ?????? ????????? ????????? ????????? ???????????????.
- `"?????????"`: ??????????????? ????????? ?????? ?????? ???????????? ???????????? ?????? ????????? ????????? ??????.

---



##### 5. ????????? ?????? ?????? ????????????

- ?????? ???????????? ????????? ?????? ????????? ?????? ?????? ?????? ??????


```{r eval=F}
# ?????????
reply_dislike %>% find_word(x = reply_raw, keyword = "?????????", n = 10)
```

```{r echo=F}
# ?????????
reply_dislike %>% find_word(x = reply_raw, keyword = "?????????", n = 3)
```

---

```{r eval=F}
# "?????????" ?????? ?????? ?????? ??? "??????" ????????? ?????? ??????
reply_dislike %>%
  filter(!str_detect(reply, "?????????")) %>%
  find_word(x = reply, keyword = "??????", n = 10)
```

```{r echo=F}
# "?????????" ?????? ?????? ?????? ??? "??????" ????????? ?????? ??????
reply_dislike %>%
  filter(!str_detect(reply, "?????????")) %>%
  find_word(x = reply, keyword = "??????", n = 3)
```

---

```{r eval=F}
# ??????
reply_dislike %>% find_word(x = reply, keyword = "??????", n = 10)
```

```{r echo=F}
# ??????
reply_dislike %>% find_word(x = reply, keyword = "??????", n = 3)
```

---

##### ?????? ?????? ????????? ?????? ??????
- `"?????????"`: ????????? ???????????? ????????? ??????????????? ????????? ?????? ??? ??????.
- `"??????"`: ????????? ?????? ????????? ???????????? ??????. ????????? ????????? ???????????? ????????? ?????????.
- `"??????"`: ????????? ???????????? ????????? ???????????? ????????? ????????? ?????? ??????.

---

##### 5. ?????? ?????? ????????????

 <br10>

- ????????? ?????? ?????? ??????
  - ?????? ????????? ?????????????????? ???????????? ????????? ??????
  - ????????? ???????????? ????????? ?????? ?????? ???????????? ????????? ??????


- ????????? ?????? ?????? ??????
  - ????????? ????????? ?????????????????? ????????? ?????? ??? ??????
  - ????????? ?????? ????????? ???????????? ??????
  - ????????? ???????????? ???????????? ??????


---

name: 07-3
class: title1

07-3 ?????? ?????? ????????????

---


##### ?????? ??????
- 1.????????? ?????????????????? ????????? TF-IDF??? ????????????.
- 2.??????????????? ?????? ????????? ????????? ?????? ???????????? ????????????.
- 3.?????? ????????? ????????? ????????? ????????? ????????? ???????????????.

---
<br-back-20>
#### TF-IDF ?????????

- ?????? ??????, ??????, ??????????????? ?????? ?????? ????????? TF-IDF ?????????

##### 1. ??????????????? ?????? ?????? ?????????

```{r}
# ?????? ?????? ??????
category1 <- "?????? ??????|????????????|??????"
category2 <- "??????"
category3 <- "????????????|?????????|???????????????|?????????|??????|?????????|??????????????????"

# ?????? ??? ??????
bind_category <- bind_rows(
  word_sympathy %>%
    filter(str_detect(reply, category1)) %>%
    mutate(category = "????????????"),

  word_sympathy %>%
    filter(str_detect(reply, category2)) %>%
    mutate(category = "??????"),

  word_sympathy %>%
    filter(str_detect(reply, category3)) %>%
    mutate(category = "????????????"))
```

`r fontawesome("lightbulb")` ?????? ????????? ?????? ????????? ????????? ?????? ????????? `bind_category`?????? ?????? ????????? ????????? ??????????????? ?????? ?????? ??????(ex: `"????????????"`??? `"??????"`??? ?????? ????????? ??????)

`r icon_style(fontawesome("exclamation-triangle"), fill = "#FF7333")`  `str_detect()`??? ????????? ????????? ????????? `|`??? ??????
 
---

##### 2. ??????????????? ?????? ?????? ????????????

- `bind_category`??? ??? ?????? ????????? ????????? ?????????
- ???????????? ????????? ?????? ???????????? ????????? ??? ????????? ?????? ??? ?????? ?????????

```{r}
# ??????????????? ??????
bind_category %>%
  group_by(id) %>%
  distinct(category, .keep_all = T) %>%
  ungroup() %>%
  count(category)
```


---

#### 3. TF-IDF ?????????

##### 3.1 ????????? ?????? ?????????

- ??????????????? ??????????????? ???????????? ?????? ?????? ?????????
- ?????? ?????? ????????? ????????? ???????????? ??? ?????? ???????????? ???????????? ???
```{r}
# ????????? ?????? ??????
stopword_category <- c("?????? ??????", "????????????", "??????", "??????",
                       "??????", "????????????", "?????????", "???????????????",
                       "?????????", "??????", "?????????", "??????????????????")
```

---

##### 3.2 ?????? ?????? ???????????? ??????????????? ?????? ?????? ?????????

- ????????? ?????? ???????????? ?????? ???????????? TF-IDF??? ?????? ?????? ???????????? ?????? ?????? ?????? ?????? 

- TF-IDF??? ?????? ?????? ????????? ????????? ??????????????? ?????? ????????? ?????? ????????? ????????? ??? ?????????<br> 
????????? ??? ????????? ?????? ??? ?????????????????? ?????? ?????? ??????

```{r}
# ??????????????? ?????? ?????? ?????????
frequency_category <- bind_category %>%
  filter(!word %in% stopword_category) %>%  # ????????? ??????

  group_by(id) %>%                          # ????????? ??????
  distinct(word, .keep_all = T) %>%         # ?????? ??? ?????? ?????? ??????
  ungroup() %>%                             # ?????? ??????

  count(category, word, sort = T) %>%       # ??????????????? ?????? ??????
  filter(str_count(word) >= 2)              # 2?????? ?????? ??????
```


---

##### 3.2 TF-IDF ?????????

```{r tfidf_category}
# tf-idf ?????????
tfidf_category <- frequency_category %>%
  bind_tf_idf(term = word,
              document = category,
              n = n) %>%
  arrange(-tf_idf)

tfidf_category
```


---


#### ??????????????? ?????? ?????? ????????????


#### 1. ????????? ?????? ?????????

.scroll-box-24[
```{r}
# ?????? ?????? ??????, ????????? ??????
tfidf_category %>%
  group_by(category) %>%
  slice_max(tf_idf, n = 15, with_ties = F) %>% 
  print(n = Inf)
```
]

---

```{r}
# ????????? ?????? ??????
stopword_tfidf <- c("?????????????????????", "?????????", "??????")
```

---

#### 2. ?????? ?????? ????????????

```{r}
# ?????? ?????? ??????
top10 <- tfidf_category %>%
  filter(!word %in% stopword_tfidf) %>%
  group_by(category) %>%
  slice_max(tf_idf, n = 10, with_ties = F)
```

---

#### 3. ?????? ????????? ?????????


```{r}
# ????????? ?????? ?????????
top10$category <- factor(top10$category,
                         levels = c("????????????", "??????", "????????????"))
```

---

```{r p_top10_tfidf, fig.show='hide'}
# ?????? ????????? ?????????
ggplot(top10, aes(x = reorder_within(word, tf_idf, category),
                  y = tf_idf,
                  fill = category)) +
  geom_col(show.legend = F) +
  coord_flip() +
  facet_wrap(~ category, scales = "free", ncol = 3) +
  scale_x_reordered() +
  scale_y_continuous(n.breaks = 5,
                     labels = number_format(accuracy = .001)) +

  labs(title = "?????? ????????? ?????? ?????? ?????? ??????",
       subtitle = "??????????????? TF-IDF Top 10",
       x = NULL) +

  theme_minimal() +
  theme(text = element_text(family = "nanumgothic"),
        plot.title = element_text(size = 14, face = "bold"),
        plot.subtitle = element_text(size = 12),
        strip.text = element_text(size = 11))  # ??????????????? ??????
```

---

```{r ref.label='p_top10_tfidf', echo=F, fig.width=8, fig.height=5}

```

---



#### ??????????????? ?????? ?????? ????????????

##### 1. ?????? ?????? ????????????

```{r}
# ?????? ?????? ??????
reply_category <- bind_category %>%
  group_by(category) %>%
  distinct(id, .keep_all = T)
```

---

##### 2. ?????? ?????? ????????????

```{r eval=F}
# ???????????? ????????????
reply_category %>%
  filter(category == "????????????") %>%
  find_word(x = reply_raw, keyword = "?????????")
```

```{r echo=F}
reply_category %>%
  filter(category == "????????????") %>%
  find_word(x = reply_raw, keyword = "?????????", n = 3)
```

---

```{r eval=F}
# ?????? ????????????
reply_category %>%
  filter(category == "??????") %>%
  find_word(x = reply_raw, keyword = "??????")
```

```{r echo=F}
reply_category %>%
  filter(category == "??????") %>%
  find_word(x = reply_raw, keyword = "??????", n = 3)
```

---

```{r eval=F}
# ???????????? ????????????
reply_category %>%
  filter(category == "????????????") %>%
  find_word(x = reply_raw, keyword = "?????????")
```


```{r echo=F}
reply_category %>%
  filter(category == "????????????") %>%
  find_word(x = reply_raw, keyword = "?????????", n = 3)
```

---

name: 07-4
class: title1

07-4 ?????? ??? ?????? ????????????

---

#### ?????? ????????? ?????? ??? ???????????? ????????????

##### ?????? ??????
- 1.?????? ????????? ?????? ?????? ????????? ???????????? ??? ????????? ???????????????.
- 2.?????? ???????????? ????????? ?????? ????????? ???????????????.
- 3.???????????? ???????????? ????????? ????????? ????????? ???????????????.
- 4.???????????? ????????? ????????? ????????? ????????? ???????????????.

---

##### 1. ?????? ?????? ?????????

##### 1.1 ???????????????

- ?????? ????????? ????????? `tada`??? `reply`??? ???????????? ??????, ??????, ???????????? ??????

```{r pos_tada}
# ?????????
pos_tada <- tada %>%
  unnest_tokens(input = reply,
                output = word_pos,
                token = SimplePos22,
                drop = F)
```

---

```{r separate_pos_tada}
# ?????? ?????? ??????
separate_pos_tada <- pos_tada %>%
  separate_rows(word_pos, sep = "[+]") %>%                   # ?????? ?????? ??????
  filter(str_detect(word_pos, "/n|/pv|/pa")) %>%             # ?????? ??????
  mutate(word = ifelse(str_detect(word_pos, "/pv|/pa"),      # "/pv", "/pa" ??????
                       str_replace(word_pos, "/.*$", "???"),  # "~???"??? ?????????
                       str_remove(word_pos, "/.*$"))) %>%    # ?????? ??????
  filter(str_count(word) >= 2) %>%                           # 2?????? ?????? ??????
  arrange(id)
```


---

```{r}
separate_pos_tada %>%
  select(word)
```

---

##### 1.2 ?????? ?????? ?????????

```{r}
library(widyr)
word_cors <- separate_pos_tada %>%
  add_count(word) %>%
  filter(n >= 20) %>%
  pairwise_cor(item = word, feature = id, sort = T)

word_cors
```

---



##### 2. ?????? ????????? ???????????? ??? ????????? ?????? ????????? ?????????

<br10>

.scroll-box-26[

```{r }
target <- c("??????", "??????", "??????")

# ?????? 10??? ??????
top_cors <- word_cors %>%
  filter(item1 %in% target) %>%
  group_by(item1) %>%
  slice_max(correlation, n = 10)

top_cors
```
]

---

```{r p_top_cors_phi, fig.show='hide'}
# ????????? ?????? ?????????
top_cors$item1 <- factor(top_cors$item1, levels = target)

# ?????? ????????? ?????????
ggplot(top_cors, aes(x = reorder_within(item2, correlation, item1),
                     y = correlation,
                     fill = item1)) +
  geom_col(show.legend = F) +
  facet_wrap(~ item1, scales = "free") +
  coord_flip() +
  scale_x_reordered() +

  labs(title = "?????? ????????? ?????? ?????? ?????? ??????",
       subtitle = "?????? ?????? Top 10",
       x = NULL) +

  theme_minimal() +
  theme(text = element_text(family = "nanumgothic"),
        plot.title = element_text(size = 14, face = "bold"),
        plot.subtitle = element_text(size = 12),
        strip.text = element_text(size = 11))
```

---

```{r ref.label='p_top_cors_phi', echo=F}

```

---

##### ?????? ????????? ???????????? ??? ?????? ??????

<br10>

- **??????**
  - `"??????"`: ????????? ?????? ????????? ????????? ?????? ????????? ??????
  - `"?????????"`, `"?????????"`, `"??????"`, `"??????"`: ????????? ????????? ????????? ???????????? ???????????? ??????


- **??????** 
  - `"??????"`: ????????? ?????? ????????? ????????? ?????? ????????? ??????
  - `"?????????"`, `"????????????"`, `"?????????"`, `"??????"`, `"?????????"`: ?????? ???????????? ????????? ??????????????? ???????????? ???????????? ???????????? ??????


- **??????** 
  - `"??????"`: ????????? ????????? ?????? ????????? ??????????????? ???????????? ????????? ????????? ????????? ??????
  - `"??????"`, `"??????"`, `"??????"`, `"??????"`, `"??????"`, `"??????"`: ????????? ????????? ????????? ???????????? ????????? ????????? ???????????? ???????????? ??????

---


##### 3. ???????????? ????????? ?????????

```{r message=F}
# ???????????? ????????? ????????? ?????????
library(tidygraph)
set.seed(1234)
graph_cors <- word_cors %>%
  filter(correlation >= 0.15) %>%
  as_tbl_graph(directed = F) %>%
  mutate(centrality = centrality_degree(),       # ?????????
         group = as.factor(group_infomap()))     # ????????????
```

---

```{r p_graph_cors, fig.show='hide'}
# ???????????? ????????? ?????????
library(ggraph)
set.seed(1234)
ggraph(graph_cors, layout = "fr") +              # ????????????

  geom_edge_link(color = "gray50",               # ?????? ??????
                 aes(edge_alpha = correlation,   # ?????? ??????
                     edge_width = correlation),  # ?????? ??????
                 show.legend = F) +              # ?????? ??????
  scale_edge_width(range = c(1, 4)) +            # ?????? ?????? ??????

  geom_node_point(aes(size = centrality,         # ?????? ??????
                      color = group),            # ?????? ??????
                  show.legend = F) +             # ?????? ??????
  scale_size(range = c(5, 10)) +                 # ?????? ?????? ??????

  geom_node_text(aes(label = name),              # ????????? ??????
                 repel = T,                      # ????????? ??????
                 size = 5,                       # ????????? ??????
                 family = "nanumgothic") +       # ??????

  theme_graph()                                  # ?????? ??????
```

---

`r fontawesome("lightbulb")` ????????? ????????? ?????? ?????? ?????? ?????? ?????? ?????? ???????????? ????????????: ????????? `windows()`, ??? `x11()` ??????

---

<br-back-40>

```{r, echo=FALSE}
include_graphics("Image/07/07_4_2.png")
```

---




##### 4. ?????? ?????? ????????????


**??????-??????-??????** : 2020?????? ?????? ???????????? ????????? ???????????? ????????? ??????????????? ??????

```{r eval=F}
tada %>%
  filter(str_detect(reply_raw, "??????")) %>%
  find_word(x = reply_raw, keyword = "??????", n = 10)
```

```{r echo=F}
tada %>%
  filter(str_detect(reply_raw, "??????")) %>%
  find_word(x = reply_raw, keyword = "??????", n = 3)
```

---

##### 4. ?????? ?????? ????????????

**??????-??????-??????** : 2020?????? ?????? ???????????? ????????? ???????????? ????????? ??????????????? ??????

```{r eval=F}
tada %>%
  filter(str_detect(reply_raw, "??????")) %>%
  find_word(x = reply_raw, keyword = "??????", n = 10)
```

```{r echo=F}
tada %>%
  filter(str_detect(reply_raw, "??????")) %>%
  find_word(x = reply_raw, keyword = "??????", n = 3)
```

---

##### 4. ?????? ?????? ????????????

**?????????-??????-?????????** : ?????? ????????? ????????? ?????? ???????????? ??????

```{r eval=F}
tada %>%
  filter(str_detect(reply_raw, "?????????")) %>%
  find_word(x = reply_raw, keyword = "??????", n = 10)
```

```{r echo=F}
tada %>%
  filter(str_detect(reply_raw, "?????????")) %>%
  find_word(x = reply_raw, keyword = "??????", n = 3)
```

---

##### 4. ?????? ?????? ????????????

**?????????-??????-?????????** : ?????? ????????? ????????? ?????? ???????????? ??????

```{r eval=F}
tada %>%
  filter(str_detect(reply_raw, "??????")) %>%
  find_word(x = reply_raw, keyword = "??????", n = 10)

```

```{r echo=F}
tada %>%
  filter(str_detect(reply_raw, "??????")) %>%
  find_word(x = reply_raw, keyword = "??????", n = 3)

```


---

.box[

.info[`r icon_style(fontawesome("rocket"), fill = "#FF7333")` ???????????? ???????????? ?????? ?????? ????????????]

- `"??????"`??? ????????? ???????????? ????????? `"?????????"`??? ??????????????? ????????? `"??????"`??? ????????? ?????? ??????
- ?????? ????????? ????????? ????????? ?????? ?????? ????????? ????????? ?????? ???????????? ??? ?????? ??????

```{r eval = F}
separate_pos_tada %>%
  filter(word == "?????????") %>%
  pull(reply_raw)
```
```{r echo = F}
separate_pos_tada %>%
  filter(word == "?????????") %>%
  head(3) %>% 
  pull(reply_raw)
```

]


---



#### ??????????????? ????????? ????????? ?????? ????????????

##### ?????? ??????
- 1.????????? ?????????????????? ???????????? ????????? ????????????.
- 2.???????????? ???????????? ????????? ????????? ????????? ???????????????.
- 3.???????????? ???????????? ????????? ????????? ????????? ????????? ???????????????.

---


##### 1. ?????????????????? ???????????? ?????? ?????????

```{r out_bigram_comment, results='hide'}
# ??? ????????? ????????? ?????? ??????????????? ??????
line_comment <- separate_pos_tada %>%
  group_by(id) %>%
  summarise(sentence = paste(word, collapse = " "))

# ?????????????????? ?????????
bigram_comment <- line_comment %>%
  unnest_tokens(input = sentence,
                output = bigram,
                token = "ngrams",
                n = 2)

bigram_comment
```

---
```{r ref.label="out_bigram_comment", echo=F}
```

---

```{r out_pair_bigram, results='hide'}
# ???????????? ????????????
bigram_seprated <- bigram_comment %>%
  separate(bigram, c("word1", "word2"), sep = " ")

# ????????? ?????? ?????????
pair_bigram <- bigram_seprated %>%
  count(word1, word2, sort = T) %>%
  na.omit()

pair_bigram
```

---
```{r ref.label="pair_bigram", echo=F}
```

---
##### 2. ???????????? ????????? ?????????


```{r}
# ???????????? ????????? ????????? ?????????
set.seed(1234)
graph_bigram <- pair_bigram %>%
  filter(n >= 8) %>%
  as_tbl_graph(directed = F) %>%
  mutate(centrality = centrality_degree(),       # ?????????
         group = as.factor(group_infomap()))     # ????????????
```


---

```{r p_graph_bigram, fig.show='hide'}
# ???????????? ????????? ?????????
set.seed(1234)
ggraph(graph_bigram, layout = "fr") +            # ????????????

  geom_edge_link(color = "gray50",               # ?????? ??????
                 alpha = 0.5) +                  # ?????? ??????

  geom_node_point(aes(size = centrality,         # ?????? ??????
                      color = group),            # ?????? ??????
                  show.legend = F) +             # ?????? ??????
  scale_size(range = c(5, 15)) +                 # ?????? ?????? ??????

  geom_node_text(aes(label = name),              # ????????? ??????
                 repel = T,                      # ????????? ??????
                 size = 5,                       # ????????? ??????
                 family = "nanumgothic") +       # ??????

  theme_graph()                                  # ?????? ??????
```

---
<br-back-20>

```{r, echo=FALSE, out.width='90%'}
include_graphics("Image/07/07_4_3.png")
```

---

##### 3. ?????? ?????? ????????????

##### 3.1 `line_comment`??? `tada` ????????????

```{r, R.options=list(tibble.width = 30)}
line_tada <- line_comment %>%
  left_join(tada, by = "id")

line_tada %>%
  select(sentence)
```

---

##### 3.2 ?????? ?????? ????????????

- **??????-??????-???????????????** : ?????? ????????? ????????? ???????????? ??????????????? ??????

```{r eval=F}
line_tada %>%
  filter(str_detect(sentence, "?????? ??????")) %>%
  find_word(x = reply_raw, keyword = "??????", n = 10)
```

```{r echo=F}
line_tada %>%
  filter(str_detect(sentence, "?????? ??????")) %>%
  find_word(x = reply_raw, keyword = "??????", n = 3)
```


---

##### 3.2 ?????? ?????? ????????????

- **??????-??????-???????????????** : ?????? ????????? ????????? ???????????? ??????????????? ??????

```{r eval=F}
line_tada %>%
  filter(str_detect(sentence, "?????? ???????????????")) %>%
  find_word(x = reply_raw, keyword = "?????????", n = 10)
```

```{r echo=F}
line_tada %>%
  filter(str_detect(sentence, "?????? ???????????????")) %>%
  find_word(x = reply_raw, keyword = "?????????", n = 3)
```

---

- **??????-??????-??????**
   - ?????? ?????? ????????? ???????????? ??????
   - ????????? ????????? ???????????? ????????? ?????? ???????????? ????????? ??????

```{r eval=F}
line_tada %>%
  filter(str_detect(sentence, "?????? ??????")) %>%
  find_word(x = reply_raw, keyword = "??????", n = 10)
```

```{r echo=F}
line_tada %>%
  filter(str_detect(sentence, "?????? ??????")) %>%
  find_word(x = reply_raw, keyword = "??????", n = 3)
```

---
- **??????-??????-??????**
   - ?????? ?????? ????????? ???????????? ??????
   - ????????? ????????? ???????????? ????????? ?????? ???????????? ????????? ??????

```{r eval=F}
line_tada %>%
  filter(str_detect(sentence, "?????? ??????")) %>%
  find_word(x = reply_raw, keyword = "??????", n = 10)
```

```{r echo=F}
line_tada %>%
  filter(str_detect(sentence, "?????? ??????")) %>%
  find_word(x = reply_raw, keyword = "??????", n = 3)
```

`r fontawesome("lightbulb")` `"??????"`??? ????????? ???????????? ????????? `"??????"`??? ??????????????? ????????? `"??????"`??? ????????? ?????? ??????

---



<!-- ## 7.5 ?????? ????????? -->

<!-- > [??????] '?????? ??????' ?????? ??? ?????? -->

<!-- ?????? ????????? ????????? ????????? ?????? ???????????? ??????????????? ?????????????????????. -->


<!-- ### 7.5.1 ?????? ???????????? ?????? ????????? -->

<!-- ?????? ?????? ????????? ???????????? ???????????? `tada`??? ????????????????????????. ?????? ????????? ?????? ????????? ????????? ??? ????????? ?????????????????????. ?????? ?????? ?????? ??? ?????? ????????? ????????? ?????? ????????? ?????????????????????. -->

<!-- ```{r eval=F} -->
<!-- # ?????? ?????? -->
<!-- noun_tada <- tada %>% -->
<!--   distinct(reply, .keep_all = T) %>%                   # ?????? ?????? ?????? -->
<!--   filter(str_count(reply, boundary("word")) >= 3) %>%  # ?????? ?????? ?????? -->
<!--   unnest_tokens(input = reply,                         # ?????? ?????? -->
<!--                 output = word, -->
<!--                 token = extractNoun, -->
<!--                 drop = F) %>% -->
<!--   filter(str_count(word) > 1) -->

<!-- # ??????, ????????? ?????? ?????? -->
<!-- unique_noun_tada <- noun_tada %>% -->
<!--   group_by(id) %>%                                     # ?????? ?????? ?????? -->
<!--   distinct(word, .keep_all = T) %>% -->
<!--   ungroup() %>% -->
<!--   add_count(word) %>%                                  # ????????? ?????? ?????? -->
<!--   filter(n <= 200) %>% -->
<!--   select(id, word) -->
<!-- ``` -->

<!-- ```{r echo=F} -->
<!-- # saveRDS(unique_noun_tada, "unique_noun_tada.rds") -->
<!-- unique_noun_tada <- readRDS(here::here("preprocessing/news_coments/tada/unique_noun_tada.rds")) -->
<!-- ``` -->


<!-- ```{r eval=F} -->
<!-- unique_noun_tada -->
<!-- ``` -->


<!-- ```{r echo=F} -->
<!-- unique_noun_tada %>% -->
<!--   print(n = 5) -->
<!-- ``` -->


<!-- ### 7.5.2 LDA ?????? ????????? -->

<!-- `unique_noun_tada`??? ????????? LDA ????????? ??????????????????. -->


<!-- #### 1. ????????? ?????? ????????? ????????? DTM ????????? -->

<!-- ?????? ????????? ?????? ????????? ?????? ?????? DTM ??? ??????????????????. -->

<!-- ```{r} -->
<!-- # ????????? ?????? ?????? ????????? -->
<!-- count_word <- unique_noun_tada %>% -->
<!--   count(id, word, sort = T) -->

<!-- # DTM ????????? -->
<!-- dtm_tada <- count_word %>% -->
<!--   cast_dtm(document = id, term = word, value = n) -->

<!-- dtm_tada -->
<!-- ``` -->

<!-- #### 2. ????????????????????? ???????????? ?????? ??? ????????? -->

<!-- ?????? ?????? 2?????? 20?????? ???????????? ????????? ?????? ?????? ?????? ????????? ?????? ?????? ????????? ?????????????????????. -->

<!-- > [??????] ?????? ????????? 19?????? LDA ????????? ????????????. ????????? ????????? ?????? ???????????? ??? ?????? ?????? ??? ????????????. -->

<!-- ```{r eval=F} -->
<!-- library(ldatuning) -->
<!-- models_tada <- FindTopicsNumber(dtm = dtm_tada, -->
<!--                                 topics = 2:20, -->
<!--                                 return_models = T, -->
<!--                                 control = list(seed = 1234)) -->
<!-- ``` -->

<!-- ```{r fig.height=3, fig.width=6, echo=F} -->
<!-- library(ldatuning) -->
<!-- # saveRDS(models_tada, "models_tada.rds") -->
<!-- models_tada <- readRDS(here::here("preprocessing/news_coments/tada/models_tada.rds")) -->
<!-- ``` -->

<!-- ```{r fig.height=3, fig.width=6} -->
<!-- # ?????? ?????? ????????? -->
<!-- FindTopicsNumber_plot(models_tada) -->
<!-- ``` -->

<!-- ???????????? ?????? ?????? ?????? 9?????? ???????????? ?????? ????????? ??????????????? ??????????????? ??? ????????? ????????? ???????????????. ?????? ?????? ?????? 9?????? ????????? `models_tada`?????? ?????? ?????? 9?????? ????????? ????????? ????????? ?????????????????????. -->

<!-- ```{r} -->
<!-- # ?????? ?????? 9?????? ?????? ?????? -->
<!-- lda_model <- models_tada %>% -->
<!--   filter(topics == 9) %>% -->
<!--   pull(LDA_model) %>%              # ?????? ?????? -->
<!--   .[[1]]                           # list ?????? -->

<!-- lda_model -->
<!-- ``` -->

<!-- ### 7.5.3 ????????? ?????? ?????? ???????????? -->

<!-- ??? ????????? ????????? ????????? ?????? ?????? ????????? ?????????????????????. -->

<!-- #### 1. ?????? ?????? ???????????? -->

<!-- ?????? `lda_model`?????? ????????? ?????? ????????? ????????? `beta`??? ?????????????????????. ?????? ?????? `beta`??? ?????? ?????? 15??? ????????? ????????? ????????? ?????????????????????. -->

<!-- ```{r } -->
<!-- # ????????? ?????? ?????? beta ?????? -->
<!-- term_topic <- tidy(lda_model, matrix = "beta") -->
<!-- ``` -->

<!-- ```{r eval=F} -->
<!-- # ????????? beta ?????? ?????? ?????? -->
<!-- term_topic %>% -->
<!--   group_by(topic) %>% -->
<!--   slice_max(beta, n = 15) %>% -->
<!--   print(n = Inf) -->
<!-- ``` -->

<!-- ```{r echo=F} -->
<!-- # ????????? beta ?????? ?????? ?????? -->
<!-- term_topic %>% -->
<!--   group_by(topic) %>% -->
<!--   slice_max(beta, n = 15) %>% -->
<!--   print(n = 5) -->
<!-- ``` -->

<!-- #### 2. ????????? ???????????? ?????? 10??? ?????? ???????????? -->

<!-- ?????? ????????? ?????? `"??????"`, `"??????"`??? ?????? ????????? ??? ??? ?????? ????????? ???????????? ????????????. ?????? ????????? ????????? ???????????? ????????? ???????????? `bata`??? ?????? ?????? 10??? ????????? ?????????????????????. -->

<!-- ```{r} -->
<!-- # ????????? ?????? ?????? -->
<!-- stopword_lda <- c("??????", "??????", "??????", "??????", "??????", "??????", "??????", -->
<!--                   "??????", "??????", "??????", "??????", "??????", "??????", "??????") -->

<!-- # ????????? ?????? ??? ?????? 10??? ?????? ?????? -->
<!-- top_term_topic <- term_topic %>% -->
<!--   filter(!term %in% stopword_lda) %>% -->
<!--   group_by(topic) %>% -->
<!--   slice_max(beta, n = 10) -->
<!-- ``` -->

<!-- ```{r eval=F} -->
<!-- top_term_topic -->
<!-- ``` -->

<!-- ```{r echo=F} -->
<!-- top_term_topic %>% -->
<!--   print(n = 5) -->
<!-- ``` -->


<!-- #### 3. ?????? ????????? ????????? -->

<!-- `top_term_topic`?????? ?????? ???????????? ??????????????????. ????????? ??????????????? ??? ????????? ?????? ????????? ?????? ????????? ?????? ?????? ????????? ??? ????????? ?????? ??? ??? ????????????. -->

<!-- ```{r fig.height=8, fig.width=8} -->
<!-- ggplot(top_term_topic, aes(x = reorder_within(term, beta, topic), -->
<!--                            y = beta, -->
<!--                            fill = factor(topic))) + -->
<!--   geom_col(show.legend = F) + -->
<!--   facet_wrap(~ topic, scales = "free", ncol = 3) + -->
<!--   coord_flip() + -->
<!--   scale_x_reordered() + -->
<!--   labs(x = NULL) + -->
<!--   theme(text = element_text(family = "nanumgothic")) -->
<!-- ``` -->


<!-- ### 7.5.4 ???????????? ?????? ???????????? -->

<!-- ????????? ????????? ?????? ???????????? ????????? ?????? ???????????? ????????? ?????????????????????. ?????? `lda_model`?????? ????????? ?????? ????????? ????????? `gamma`??? ????????? ??????, ???????????? `gamma`??? ?????? ?????? ????????? ??????????????????. ?????? ?????? ?????? ????????? ????????? ?????? ????????? ?????????????????????. -->

<!-- ```{r} -->
<!-- # ????????? ?????? ?????? gamma ???????????? -->
<!-- doc_topic <- tidy(lda_model, matrix = "gamma") -->

<!-- # ???????????? ????????? ?????? ?????? ?????? ?????? -->
<!-- doc_class <- doc_topic %>% -->
<!--   group_by(document) %>% -->
<!--   slice_max(gamma, n = 1) -->
<!-- ``` -->


<!-- ```{r eval=F} -->
<!-- doc_class -->
<!-- ``` -->

<!-- ```{r echo=F} -->
<!-- doc_class %>% -->
<!--   print(n = 5) -->
<!-- ``` -->


<!-- ```{r} -->
<!-- # integer??? ?????? -->
<!-- doc_class$document <- as.integer(doc_class$document) -->

<!-- # ????????? ?????? ?????? ?????? -->
<!-- tada_topic <- tada %>% -->
<!--   left_join(doc_class, by = c("id" = "document")) -->
<!-- ``` -->


<!-- ### 7.5.5 ????????? ?????? ?????? ?????? ??????????????? -->

<!-- ????????? ?????? ?????? ?????? ????????? ????????? ?????? ???????????? ??????????????????. -->

<!-- #### 1. ????????? ?????? ?????? ?????? ????????? -->

<!-- ?????? ????????? ?????? ?????? `beta`??? ?????? ?????? `term_topic`?????? ???????????? ????????????, ???????????? `beta`??? ?????? ?????? ????????? 6?????? ????????? ?????? ??? ????????? ?????????????????????. -->

<!-- ```{r} -->
<!-- top_terms <- term_topic %>% -->
<!--   filter(!term %in% stopword_lda) %>% -->
<!--   group_by(topic) %>% -->
<!--   slice_max(beta, n = 6, with_ties = F) %>% -->
<!--   summarise(term = paste(term, collapse = ", ")) -->

<!-- top_terms -->
<!-- ``` -->

<!-- #### 2. ????????? ?????? ?????? ????????? -->

<!-- ????????? ?????? ????????? ???????????? `tada_topic`??? ????????? ????????? ?????? ????????? ??????????????????. -->
<!-- ```{r} -->
<!-- count_topic <- tada_topic %>% -->
<!--   count(topic) %>% -->
<!--   na.omit() -->
<!-- ``` -->

<!-- ```{r eval=F} -->
<!-- count_topic -->
<!-- ``` -->

<!-- ```{r echo=F} -->
<!-- count_topic %>% -->
<!--   print(n = 5) -->
<!-- ``` -->


<!-- #### 3. ?????? ????????? ?????? ?????? ???????????? -->

<!-- `count_topic`??? `top_terms`??? ????????????, ?????? ???????????? x?????? ?????? ????????? ???????????? ?????? `topic_name`??? ?????????????????????. -->

<!-- ```{r} -->
<!-- count_topic_word <- count_topic %>% -->
<!--   left_join(top_terms, by = "topic") %>% -->
<!--   mutate(topic_name = paste("Topic", topic)) -->

<!-- count_topic_word -->
<!-- ``` -->

<!-- > [??????] ?????? ????????? -->

<!-- #### 4. ?????? ????????? ????????? -->

<!-- `count_topic_word`??? ????????? ?????? ???????????? ??????????????????. ????????? ???????????? ?????? ????????? ????????? ????????? ?????? ??? ?????? ??? ??? ????????????. -->

<!-- ```{r} -->
<!-- library(scales) -->
<!-- ggplot(count_topic_word, -->
<!--        aes(x = reorder(topic_name, n), -->
<!--            y = n, -->
<!--            fill = topic_name)) + -->
<!--   geom_col(show.legend = F) + -->
<!--   coord_flip() + -->

<!--   geom_text(aes(label = comma(n, accuracy = 1)),  # ?????? ?????? ?????? -->
<!--             hjust = -0.2) + -->

<!--   geom_text(aes(label = term),                    # ?????? ?????? ?????? -->
<!--             hjust = 1.03, -->
<!--             col = "white", -->
<!--             fontface = "bold", -->
<!--             family = "nanumgothic") + -->

<!--   scale_y_continuous(expand = c(0, 0),            # y???-?????? ?????? ????????? -->
<!--                      limits = c(0, 1100)) +       # y??? ?????? -->

<!--   labs(title = "?????? ????????? ?????? ?????? ??????", -->
<!--        subtitle = "????????? ?????? ?????? ??? ?????? ??????", -->
<!--        x = NULL, y = NULL) + -->

<!--   theme_minimal() + -->
<!--   theme(text = element_text(family = "nanumgothic"), -->
<!--         plot.title = element_text(size = 14, face = "bold"), -->
<!--         plot.subtitle = element_text(size = 12)) -->
<!-- ``` -->

<!-- > [??????] `geom_text()`?????? `theme()`?????? ????????? ????????? ???????????? ?????? ????????? ????????? ???????????? ?????????. -->

<!-- ### 7.5.6 ?????? ?????? ?????? -->

<!-- ????????? ????????? ??? ????????? ??? ????????? ?????? ????????? ?????? ???????????? ?????????????????????. -->

<!-- #### 1. ????????? ?????? ?????? ???????????? -->

<!-- ???????????? `gamma`??? ?????? ?????? ????????? 100?????? ????????? ????????? ?????????????????????. -->

<!-- ```{r} -->
<!-- # ????????? ?????? ?????? ?????? -->
<!-- reply_topic <- tada_topic %>% -->
<!--   group_by(topic) %>% -->
<!--   slice_max(gamma, n = 100) -->
<!-- ``` -->

<!-- <br> -->

<!-- **?????? 1** : ?????? 1??? ????????? ?????? ????????? ?????? ????????? ?????????????????? ????????? ????????? ?????? ??? ??? ????????????. -->

<!-- ```{r eval=F} -->
<!-- # ?????? 1 ?????? ???????????? -->
<!-- reply_topic %>% -->
<!--   filter(topic == 1) %>% -->
<!--   pull(reply_raw) -->
<!-- ``` -->

<!-- ```{r echo=F} -->
<!-- # ?????? 1 ?????? ???????????? -->
<!-- reply_topic %>% -->
<!--   filter(topic == 1) %>% -->
<!--   head(1) %>% -->
<!--   pull(reply_raw) -->
<!-- ``` -->

<!-- > [??????] ?????? ?????? ?????? ?????? ??????, ??? ??? ?????? -->

<!-- <br> -->

<!-- **?????? 2** : ?????? 2??? ????????? ?????? ????????? ?????? ????????? ??????????????? ????????? ????????? ?????? ??? ??? ????????????. -->

<!-- ```{r eval=F} -->
<!-- # ?????? 2 ?????? ???????????? -->
<!-- reply_topic %>% -->
<!--   filter(topic == 2) %>% -->
<!--   pull(reply_raw) -->
<!-- ``` -->


<!-- ```{r} -->
<!-- # ?????? 2 ?????? ???????????? -->
<!-- reply_topic %>% -->
<!--   filter(topic == 2) %>% -->
<!--   head(1) %>% -->
<!--   pull(reply_raw) -->
<!-- ``` -->

<!-- > [??????] ?????? ?????? ?????? ?????? ??????, ??? ??? ?????? -->

<!-- <br> -->

<!-- > [??????] ?????? 3~8??? ?????? ????????? ?????? ????????? ??????????????????. -->


<!-- #### 2. ?????? ?????? ?????? ????????? -->

<!-- ????????? ?????? ????????? ????????? ????????? ?????? ?????? ????????? ??????????????????. -->

<!-- ```{r} -->
<!-- # ?????? ?????? ?????? ????????? -->
<!-- name_topic <- tibble(topic = 1:9, -->
<!--                      name = c("1. ????????? ???????????? ??????", -->
<!--                               "2. ?????? ?????? ???????????? ??????", -->
<!--                               "3. ?????? ?????? ??????, ?????? ??????", -->
<!--                               "4. ?????? ???????????? ????????? ??????", -->
<!--                               "5. ?????????????????? ?????? ?????????", -->
<!--                               "6. ?????? ?????? ???????????? ??????", -->
<!--                               "7. ?????? ?????? ????????? ????????? ?????????", -->
<!--                               "8. ????????? ?????? ?????? ????????????", -->
<!--                               "9. ????????? ?????????, ????????? ?????? ?????????")) -->
<!-- ``` -->


<!-- #### 3. ?????? ????????? ?????? ?????? ??????????????? -->

<!-- ????????? ?????? ????????? ???????????? `top_term_topic`??? `name_topic`??? ????????? ?????? ????????? ????????? ?????? ?????? ???????????? ??????????????????. ????????? ???????????? ?????? ?????? ????????? ?????? ????????? ?????? ???????????? ????????? ?????? ????????? ??? ????????????. -->

<!-- ```{r} -->
<!-- # ?????? ?????? ???????????? -->
<!-- top_term_topic_name <- top_term_topic %>% -->
<!--   left_join(name_topic, name_topic, by = "topic") -->
<!-- ``` -->


<!-- ```{r eval=F} -->
<!-- top_term_topic_name -->
<!-- ``` -->


<!-- ```{r echo=F} -->
<!-- top_term_topic_name %>% -->
<!--   print(n = 5) -->
<!-- ``` -->

<!-- ```{r fig.height=8, fig.width=8} -->
<!-- # ?????? ????????? ????????? -->
<!-- ggplot(top_term_topic_name, -->
<!--        aes(x = reorder_within(term, beta, name), -->
<!--            y = beta, -->
<!--            fill = factor(topic))) + -->
<!--   geom_col(show.legend = F) + -->
<!--   facet_wrap(~ name, scales = "free", ncol = 3) + -->
<!--   coord_flip() + -->
<!--   scale_x_reordered() + -->

<!--   labs(title = "?????? ????????? ?????? ?????? ??????", -->
<!--        subtitle = "????????? ?????? ?????? Top 10", -->
<!--        x = NULL, y = NULL) + -->

<!--   theme_minimal() + -->
<!--   theme(text = element_text(family = "nanumgothic"), -->
<!--         plot.title = element_text(size = 14, face = "bold"), -->
<!--         plot.subtitle = element_text(size = 12), -->
<!--         axis.text.x = element_blank(),   # x??? ?????? ?????? -->
<!--         axis.ticks.x = element_blank())  # x??? ?????? ?????? -->
<!-- ``` -->


<!-- #### ????????? ????????? ????????? ????????? ???????????? -->

<!-- ????????? ?????? ?????? ?????? ?????? ????????? ????????? '?????? ?????????' ?????? ????????? ?????????????????????. ?????? ????????? ????????? ????????????, ?????? ???????????? TF-IDF??? ????????? ?????? ????????? ??????????????????. ?????? ????????? ??????????????? ????????? ????????? ????????? ????????????, ?????? ????????? ????????? ????????? ????????? ??????????????? ????????????. -->

<!-- ???????????? ??? ?????? ????????? ???????????? ????????? ?????? ?????? ?????? ????????? ????????? ??????????????? ?????? ?????? ????????? ??? ????????????. ???????????? ????????? ?????? ?????? ???????????? ?????? ??? ????????? ????????? ?????? ???????????? ????????? ?????? ??? ????????? ?????????. ????????? ???????????? ????????? ??????????????? ???????????? ??????????????? ???????????? ?????? ????????????. -->